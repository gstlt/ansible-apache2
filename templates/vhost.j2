# Generated by Ansible
{% if item['port'] is defined %}
<VirtualHost *:{{item['port']}}>
{% else %}
<VirtualHost *:{{apache2_default_port}}>
{% endif %}

        ServerName {{item['vhost_name']}}


{% if item['vhost_alias'] is defined %}
{% for host in item['vhost_alias'] %}
        ServerAlias {{host}}
{% endfor %}
{% endif %}

        ServerAdmin {{item['server_admin']}}
        DocumentRoot {{item['document_root']}}

{% if item['aliases'] is defined %}
        # Aliases
{% for alias in item['aliases'] %}
        Alias {{alias}}
{% endfor %}
{% endif %}

{% if item['directory'] is defined %}
        # Rules for directories
{% for dir in item['directory'] %}
        <Directory {{dir['path']}}>
{% if dir['options'] is defined %}
                Options {{dir['options']}}
{% else %}
                Options -Indexes -FollowSymLinks
{% endif %}
{% if dir['override'] is defined %}
                AllowOverride {{dir['override']}}
{% else %}
                AllowOverride None
{% endif %}
{% if dir['grant_lines'] is defined %}
{% for grant_line in dir['grant_lines'] %}
                {{grant_line}}
{% endfor %}
{% else %}
                Require all granted
{% endif %}
        </Directory>

{% endfor %}
{% endif %}

{% if item['location'] is defined %}
        # Rules for Location
{% for loc in item['location'] %}
        <Location {{loc['uri']}}>
{% if loc['options'] is defined %}
                Options {{loc['options']}}
{% else %}
                Options -Indexes -FollowSymLinks
{% endif %}
{% if loc['override'] is defined %}
                AllowOverride {{loc['override']}}
{% else %}
                AllowOverride None
{% endif %}
{% if loc['grant_lines'] is defined %}
{% for grant_line in loc['grant_lines'] %}
                {{grant_line}}
{% endfor %}
{% else %}
                Require all granted
{% endif %}
        </Location>

{% endfor %}
{% endif %}

{% if item['error_log'] is defined %}
        ErrorLog {{item['error_log']}}
{% else %}
        ErrorLog ${APACHE_LOG_DIR}/error.log
{% endif %}

{% if item['access_log'] is defined %}
        CustomLog {{item['access_log']}}
{% else %}
        CustomLog ${APACHE_LOG_DIR}/access.log combined
{% endif %}

</VirtualHost>

# vim: syntax=apache ts=4 sw=4 sts=4 sr noet
